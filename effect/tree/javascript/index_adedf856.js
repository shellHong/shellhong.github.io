"use strict";function branch(t){var e,a=endPt(t);branches.push(t),t.d!==maxDepth?(e=ar*Math.random()-.5*ar,angle=t.d<3?.4:da,branch({i:branches.length,x:a.x,y:a.y,a:t.a-angle+e,l:t.l*dl,d:t.d+1,parent:t.i}),e=ar*Math.random()-.5*ar,angle=t.d<3?.3:da,branch({i:branches.length,x:a.x,y:a.y,a:t.a+angle+e,l:t.l*dl,d:t.d+1,parent:t.i})):flowers.push(t)}function regenerate(){branches=[],branch(seed),create()}function endPt(t){var e=t.l;return t.d<2&&(e+=50),{x:t.x+e*Math.sin(t.a),y:t.y-e*Math.cos(t.a)}}function x1(t){return t.x}function y1(t){return t.y}function x2(t){return endPt(t).x}function y2(t){return endPt(t).y}function highlightParents(t){for(var e="mouseover"===d3.event.type?"green":"#777",a=t.d,r=0;r<=a;r++)d3.select("#id-"+parseInt(t.i)).style("stroke",e),t=branches[t.parent]}function getPoint(t,e,a,r,n){var i=a-t,c=r-e,s=n/Math.sqrt(Math.pow(i,2)+Math.pow(c,2));return[t+i*s,c+c*s]}function createHeart(){var t=d3.select("svg"),e=null;t.append("path").style("stroke","red").style("stroke-width",1).attr("d",transform("m29.727744,14.504978c11.750414,-31.304472 57.78892,0 0,40.248607c-57.78892,-40.248607 -11.750414,-71.553079 0,-40.248607z",57,53)).attr("fill-opacity",0),(e=document.querySelector("path")).classList.add("appearHeart"),e.addEventListener("click",function(){e.classList.remove("appearHeart"),e.classList.add("disappearHeart");var a=getPoint(heartStartX,heartStartY,0,winH,190),r=getPoint(0,winH,heartStartX,heartStartY,190);t.append("line").style("stroke","red").attr("x1",heartStartX).attr("y1",heartStartY).attr("x2",heartStartX).attr("y2",heartStartY).transition().delay(function(t,e){return 0}).duration(3e3).attr("x2",a[0]).attr("y2",a[1]).transition().delay(function(t,e){return 0}).duration(3e3).attr("x2",0).attr("y2",winH).attr("x1",r[0]).attr("y1",r[1]).transition().delay(function(t,e){return 0}).duration(1e3).attr("x1",0).attr("y1",winH);setTimeout(function(){document.querySelector("line").remove(),regenerate()},7500)})}function transform(t,e,a){var n=e/2,i=a/2,c=winW/2,s=winH/2;return r=t.replace(/m([-\d\.]+),([-\d\.]+)/g,function(){var t=arguments;return heartStartX=parseFloat(t[1])+c-n,heartStartY=parseFloat(t[2])+s-i,"m"+heartStartX+","+heartStartY}),r}function create(){var t=d3.select("svg"),e=winW/3,a=e/2;t.append("path").style("stroke","#cacaca").style("stroke-width",4).attr("d","m0,"+(winH-4)+"h"+e+"c"+(e+e/6)+",-65 "+(e+e/4)+",-45 "+winW+",0").attr("fill","#d4d4d4").attr("fill-opacity",0).transition().delay(function(t,e){return 5e3}).duration(500).attr("fill-opacity",1),setTimeout(function(){setTimeout(function(){t.append("path").style("stroke","#a58b8b").style("stroke-width",1).attr("d","m"+a+","+(winH-4-13)+"h100v13h-100v-13").attr("fill","#a68b9b").attr("fill-opacity",0).transition().delay(function(t,e){return 3e3}).duration(500).attr("fill-opacity",1),setTimeout(function(){document.getElementById("people").style.left=a+"px",d3.select("#people").append("path").style("stroke","#4a4a4a").style("stroke-width",1.5).attr("d","m102.36685,19.712079c-3.509374,3.348599 -18.622442,7.595834 -20.571686,7.595834l-16.566741,0c-2.749499,0 -6.890267,0.463507 -8.839511,1.526104c0.223924,0.170268 0.447849,0.340536 0.664432,0.513956c1.497724,1.195027 4.999757,2.878786 8.097991,2.878786c1.457345,0 2.654056,-0.362607 3.670893,-1.1162c4.324312,-3.175178 6.570899,-3.547245 7.874066,-3.547245c1.545446,0 2.874309,0.60855 3.65621,1.6743c1.468357,1.973845 0.389115,4.556239 -0.712153,6.580533c-2.635701,4.805334 -11.225592,9.998501 -20.538648,9.998501c-0.007342,0 -0.007342,0 -0.014684,0c-1.299496,0 -2.573296,-0.104053 -3.792033,-0.312158l0,10.250749c0,2.339605 3.792033,7.986819 15.296612,7.986819s14.518383,-11.669647 14.518383,-13.678176l0,-14.226817c8.186092,-3.685982 16.56307,-5.691357 20.571686,-12.28135c3.770007,-6.192701 0.190886,-7.192236 -3.314817,-3.843637zm-25.732962,14.901582c2.922031,-5.357128 -0.194557,-5.357128 -5.653176,-1.34007s-13.453824,0.331076 -16.181298,-1.844567c-2.727474,-2.17249 -5.454947,-3.84679 -10.329894,-3.679675c-4.874946,0.167115 -16.372184,-0.50765 -23.005488,-1.844567c-6.625962,-1.34007 -17.969023,-9.45932 -18.9051,-7.362504c-0.976458,2.175644 0.774558,3.682828 4.287603,7.362504c3.505703,3.685982 18.629783,8.75933 18.629783,8.75933s0,10.887677 0,15.406079c0,4.524708 10.913566,11.382715 16.56307,11.382715s9.940779,-3.348599 9.940779,-5.69451l0,-14.226817c9.357107,4.193632 21.731688,-1.557635 24.653719,-6.917916zm-5.873429,-11.953427c6.402038,0 11.596352,-4.458493 11.596352,-9.957511c0,-5.502171 -5.194314,-9.960664 -11.596352,-9.960664s-11.592681,4.458493 -11.592681,9.960664c0,5.499018 5.190643,9.957511 11.592681,9.957511zm-30.552845,0c6.402038,0 11.592681,-4.458493 11.592681,-9.957511c0,-5.502171 -5.190643,-9.960664 -11.592681,-9.960664c-6.405709,0 -11.596352,4.458493 -11.596352,9.960664c0,5.499018 5.186972,9.957511 11.596352,9.957511z").attr("fill-opacity",0),setTimeout(function(){t.selectAll("line").data(branches).enter().append("line").attr("x1",x1).attr("y1",y1).attr("x2",x1).attr("y2",y1).style("stroke-width",function(t){return parseInt(maxDepth+1-t.d)+"px"}).attr("id",function(t){return"id-"+t.i}).transition().delay(function(t,e){return 10*e}).duration(500).attr("x2",x2).attr("y2",y2),setTimeout(function(){t.append("defs").append("filter").attr("id","Gaussian_Blur").append("feGaussianBlur").attr("in","SourceGraphic").attr("stdDeviation",2),t.selectAll("circle").data(flowers).enter().append("circle").attr("cx",x2).attr("cy",y2).attr("r",0).attr("fill","#f7acbc").transition().delay(function(t,e){return e%3}).duration(500).attr("r",5).style("filter","url(#Gaussian_Blur)")},10*branches.length+500)},2e3)},4e3)},500)},6e3)}var winH=window.innerHeight,winW=window.innerWidth,flowers=[],branches=[],offsetH=30,startH=winH-offsetH,seed={i:0,x:winW-350,y:startH,a:0,l:120,d:0},da=.5,dl=.8,ar=.7,maxDepth=10,angle=da,heartStartX=0,heartStartY=0;createHeart();