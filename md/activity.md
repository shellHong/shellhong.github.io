# 活动架构

## 序
    `架构`是一个抽象、宽泛的定义，之所以起这个名称，是因为接下来讲的内容，有关开发，有关测试，有关商务与运营。涵盖面这么广，还是起一个牛逼的名称吧！
## 三个小故事

### 关于第三方活动

### 关于Deep Link

#### 定义
这是一种实现在不同的app间进行跳转的技术方案，其流程大致如下：

!(deeplink流程)[../../../images/work/activity/deeplink.jpg]

* Deep Link、scheme、schema
    * 简单粗暴的理解：Deep Link是实现跳转的一种技术方案，scheme、schema都是指跳转使用的路径（其实不完全是）
    * scheme是指URL的协议部分，在Deep Link中，理想状态下，一个sheme对应一个app（其实不完全是）

####  故事情节

某天，接到商务和运营一个需求，想做一个点击push进入某APP活动页面功能。
需求很简单，点了能跳就行，快速开发快速上线。
然后，开发界有一个梗"永远不要相信产品"，所以...(省略N多字)

认真分析了一下，其实只有已经安装的，能进行成功跳转，而未安装的，需要提供下载安装功能、良好的交互与视觉效果。
基于之前踩过的坑，这次决定采用一种更加灵活和复用性更强的架构，支持两种模式：

* 默认简易模式
    * 页面简单，只有APP Icon和下载按钮
    * 无需开发，只需要非常简单的配置，即可生成活动
* 自行定制模式
    * cp可根据需要自行开发定制页面UI和交互
    * 需要加入我们提供的少量代码

!(deeplink两种模式)[../../../images/work/activity/two_mode.png]

实现方式：
以承载页嵌套内容页的方式，承载页负责逻辑，由我们实现，内容页负责展示，由cp实现。两个页面通过`PostMessage`进行通信

!(PostMessage)[../../../images/work/activity/postmessage.png]

看起来很完美，然而，随着而来的是：

* 默认简易模式被嫌弃太简陋，导致每次都要定制
* cp每次都想定制，但是又不想自己开发
* 少部分愿意自己开发的cp，沟通成本非常高

### 关于埋点

目前的埋点，一般都是产品提供埋点文档，开发根据埋点文档进行开发。但是……

* 一样的逻辑功能，埋点名称不一样，文档重复
* 导数据的时候，找不到埋点文档了
* 多份埋点文档，不知道哪一个是对的

## deeplink活动模版

### 架构

### scene配置平台

### 各种工具



## 发散

## 业务前端方法论
