function Typing(a){this.version="1.1";this.source=a.source;this.output=a.output;this.delay=a.delay||120;this.brDelay=a.brDelay||0;this.end=a.end||function(){};this.chain={parent:null,dom:this.output,val:[]}}Typing.fn=Typing.prototype={toArray:function(b){var a=[];for(var c=0;c<b.length;c++){a.push(b[c])}return a},init:function(){this.chain.val=this.convert(this.source,this.chain.val)},convert:function(d,a){var c=this,b=this.toArray(d.childNodes);b.forEach(function(e){if(e.nodeType===3){a=a.concat(e.nodeValue.split(""))}else{if(e.nodeType===1){var f=[];f=c.convert(e,f);a.push({"dom":e,"val":f})}}});return a},print:function(b,a,c){setTimeout(function(){b.appendChild(document.createTextNode(a));c()},this.delay)},play:function(c){if(!c){this.end();return}if(!c.val.length&&c.parent){this.play(c.parent)}if(!c.val.length){this.end();return}var d=c.val.shift();var b=this;if(typeof d==="string"){this.print(c.dom,d,function(){if(c.val.length){b.play(c)}else{if(c.parent){b.play(c.parent)}else{b.end()}}})}else{var e=document.createElement(d.dom.nodeName);var a=b.toArray(d.dom.attributes);a.forEach(function(f){e.setAttribute(f.name,f.value)});c.dom.appendChild(e);d.parent=c;d.dom=e;if(d.dom.nodeName.toLowerCase()=="br"){setTimeout(function(){b.play(d.val.length?d:d.parent)},this.brDelay)}else{this.play(d.val.length?d:d.parent)}}},start:function(){this.init();this.play(this.chain)}};
